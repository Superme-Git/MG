# MT3项目编译前检查清单

**版本**: 1.0
**日期**: 2025-10-21
**用途**: 编译前快速验证环境和依赖完整性

---

## 📋 使用说明

**适用场景**:
- ✅ 首次编译前
- ✅ 更换开发环境后
- ✅ 编译失败时排查
- ✅ 团队新成员入职

**检查方式**:
- 逐项核对,在☐前打✓或❌
- 标记为❌的项需要修复后再编译
- 所有项✓后方可开始编译

**预计耗时**: 5-10分钟

---

## ✅ 第一部分: 开发环境检查

### 1. Visual Studio安装

```batch
# 检查命令: 打开命令提示符执行
cl
msbuild /version
```

**检查项**:

☐ **已安装Visual Studio 2013 (唯一支持版本)**
   - 版本号: _________________
   - 安装路径: _________________

☐ **可以在命令行运行 `cl` 编译器**
   - 输出版本: _________________

☐ **可以在命令行运行 `msbuild`**
   - 输出版本: _________________

☐ **已安装Windows SDK 8.1**
   - 路径: C:\Program Files (x86)\Windows Kits\8.1

---

### 2. 编译工具链

```batch
# 检查v120工具集
dir "C:\Program Files (x86)\Microsoft Visual Studio 12.0"
```

**检查项**:

☐ **v120平台工具集已安装**
   - VS2013: C:\Program Files (x86)\Microsoft Visual Studio 12.0\VC

☐ **MSBuild在PATH环境变量中**
   - 执行: `echo %PATH%` 并查找MSBuild路径

---

## 📂 第二部分: 项目文件检查

### 3. 源码完整性

```batch
# 切换到项目根目录
cd "e:\MT3"
dir
```

**检查项**:

☐ **根目录存在以下文件夹**:
   - ☐ client/
   - ☐ engine/
   - ☐ common/
   - ☐ cocos2d-2.0-rc2-x-2.0.1/
   - ☐ docs/

☐ **根目录存在编译脚本**:
   - ☐ build_mt3_v120_complete.bat
   - ☐ Build-MT3-v120.ps1
   - ☐ copy_runtime_dlls.bat

☐ **docs/目录包含技术文档（新序号体系）**:
    - ☐ 03-技术体系总结.md
    - ☐ 06-编译完整指南.md
    - ☐ 02-项目概述.md

---

### 4. 项目文件 (.vcxproj)

```batch
# 检查关键项目文件
dir /s *.vcxproj | find /c ".vcxproj"
# 应该显示多个项目文件
```

**检查项**:

☐ **所有关键项目文件存在**:
   - ☐ common\lua\lua.vcxproj
   - ☐ common\platform\platform.editor.vcxproj
   - ☐ common\ljfm\ljfm.vcxproj
   - ☐ common\cauthc\projects\windows\cauthc.win32.vcxproj
   - ☐ cocos2d-2.0-rc2-x-2.0.1\CocosDenshion\proj.win32\CocosDenshion.win32.vcxproj
   - ☐ engine\engine.win32.vcxproj
   - ☐ client\MT3Win32App\mt3.win32.vcxproj

☐ **项目文件可以用文本编辑器打开**
   - 打开任意.vcxproj文件验证不是二进制格式

---

## 🔗 第三部分: 依赖库检查

### 5. 预编译库

```batch
# 检查FireClient预编译库
dir client\FireClient\Release.win32\FireClient.lib

# 检查其他预编译库
dir cocos2d-2.0-rc2-x-2.0.1\Release.win32\*.lib
```

**检查项**:

☐ **FireClient.lib 存在** (关键!)
   - 路径: client\FireClient\Release.win32\FireClient.lib
   - 大小: __________ MB (应该>5MB)

☐ **Cocos2d-x预编译库存在**:
   - ☐ libcocos2d.lib
   - ☐ libCocosDenshion.lib

---

### 6. 运行时DLL文件

```batch
# 检查第三方DLL
cd client\resource\bin\debug
dir *.dll
```

**检查项 (必须有9个DLL)**:

☐ **libcocos2d.dll** - Cocos2d-x核心
☐ **libCocosDenshion.dll** - 音频引擎
☐ **glew32.dll** - OpenGL扩展
☐ **pthreadVCE2.dll** - 线程库
☐ **libcurl.dll** - HTTP通信
☐ **iconv.dll** - 字符编码
☐ **libxml2.dll** - XML解析
☐ **zlib1.dll** - 压缩库
☐ **fmodex.dll** - FMOD音频

**缺少DLL?** → 查看 [docs/06-编译完整指南.md](./06-编译完整指南.md:1) 第三方库章节

---

## 🎮 第四部分: 运行时验证

### 7. 原始可执行文件测试

```batch
# 运行原始版本
cd client\resource\bin\debug
MT3原始.exe
```

**检查项**:

☐ **MT3原始.exe 存在**
   - 文件大小: __________ MB

☐ **双击运行无错误**
   - ☐ 窗口正常显示
   - ☐ 无DLL缺失提示
   - ☐ 无崩溃现象

☐ **游戏基本功能正常**:
   - ☐ 登录界面显示
   - ☐ UI可以点击
   - ☐ 音乐播放

---

## 📝 第五部分: 项目配置检查

### 8. 工具集配置

```batch
# 打开任意项目文件,搜索PlatformToolset
findstr /s "PlatformToolset" *.vcxproj
```

**检查项**:

☐ **关键项目使用v120工具集**
   - 查看: client\MT3Win32App\mt3.win32.vcxproj
   - 查找: `<PlatformToolset>v120</PlatformToolset>`

☐ **所有项目配置一致**
   - 确认所有.vcxproj都使用v120

---

### 9. 字符集配置

**检查项**:

☐ **所有项目使用Unicode字符集**
   - 查找: `<CharacterSet>Unicode</CharacterSet>`

☐ **运行时库配置正确**
   - Release: `<RuntimeLibrary>MultiThreadedDLL</RuntimeLibrary>`  (/MD)
   - Debug: `<RuntimeLibrary>MultiThreadedDebugDLL</RuntimeLibrary>`  (/MDd)

---

## 🗂️ 第六部分: 磁盘空间检查

### 10. 可用空间

```batch
# 检查磁盘空间 (PowerShell)
Get-PSDrive E | Select-Object Used,Free
```

**检查项**:

☐ **项目所在磁盘可用空间充足**
   - 可用空间: __________ GB
   - 要求: ≥10GB (推荐≥20GB)

☐ **系统盘 (C:) 可用空间充足**
   - 可用空间: __________ GB
   - 要求: ≥5GB (临时文件和编译缓存)

---

## 📚 第七部分: 文档准备

### 11. 必读文档

**检查项**:

☐ **已阅读以下文档** (至少浏览一遍):
   - ☐ [README.md](../README.md) - 项目说明
   - ☐ [docs/03-技术体系总结.md](./03-技术体系总结.md:1) - 技术全貌
   - ☐ [docs/06-编译完整指南.md](./06-编译完整指南.md:1) - 编译流程
   - ☐ [.claude/项目规则.md](../.claude/项目规则.md) - 开发规范

☐ **已理解关键约束**:
   - ☐ 必须使用v120工具集
   - ☐ 不能修改FireClient.lib
   - ☐ 编译顺序很重要
   - ☐ **不支持Visual Studio 2015及更高版本**

---

## 🔧 第八部分: 快速功能测试

### 12. 工具命令测试

```batch
# 测试MSBuild
msbuild /?

# 测试编译单个模块
msbuild common\lua\lua.vcxproj /t:Build /p:Configuration=Release /p:Platform=Win32 /p:PlatformToolset=v120 /nologo
```

**检查项**:

☐ **MSBuild帮助信息显示正常**

☐ **可以成功编译单个模块 (lua.lib)**
   - 编译时间: __________ 秒
   - 生成文件: common\lua\Release.win32\lua.lib

---

## ✅ 最终确认

### 总体评估

**统计结果**:
- 总检查项: 约60项
- 已通过: ______ 项
- 未通过: ______ 项
- 跳过: ______ 项

**准备状态**:

☐ **所有关键项已通过 (✓)**
   - 开发环境 (第1-2部分)
   - 项目文件 (第3-4部分)
   - 依赖库 (第5-6部分)
   - 运行验证 (第7部分)

☐ **理解了编译流程**
   - 知道编译顺序
   - 知道编译时间预期
   - 知道如何处理错误

☐ **准备好开始编译**
   - ☐ 时间充足 (首次需要~30分钟)
   - ☐ 网络稳定 (如需下载依赖)
   - ☐ 电源稳定 (笔记本请接电源)

---

## 🚦 编译决策

### 根据检查结果判断

**如果所有关键项都✓**:
```
✅ 可以开始编译!

执行命令:
cd "e:\MT3"
build_mt3_v120_complete.bat
```

**如果有❌项**:
```
⚠️ 请先修复未通过的检查项

常见问题修复指南:
1. 缺少DLL → 查看 06-编译完整指南.md
2. v120未安装 → 查看 05-编译环境准备.md
3. 项目文件缺失 → 重新解压源码包
4. 使用了不支持的VS版本 → 必须使用Visual Studio 2013
```

**如果不确定**:
```
ℹ️ 建议先阅读文档

推荐阅读顺序:
1. 05-编译环境准备.md
2. 06-编译完整指南.md
3. 03-技术体系总结.md
```

---

## 📊 检查结果记录

### 检查信息

- **检查人**: __________________
- **检查日期**: __________________
- **环境**: Windows ________
- **VS版本**: __________________ (必须是VS2013)
- **项目路径**: __________________

### 问题记录

| 检查项 | 状态 | 问题描述 | 解决方案 |
|-------|------|---------|---------|
| | ☐✓ ☐❌ | | |
| | ☐✓ ☐❌ | | |
| | ☐✓ ☐❌ | | |

### 备注

```
(记录特殊情况或其他需要注意的事项)




```

---

## 📞 获取帮助

### 检查未通过时

1. **查看对应文档**:
   - 环境问题 → [docs/05-编译环境准备.md](./05-编译环境准备.md:1)
   - 编译问题 → [docs/06-编译完整指南.md](./06-编译完整指南.md:1)
   - 运行问题 → [docs/01-快速启动指南.md](./01-快速启动指南.md:1)

2. **搜索关键字**:
   - 在 [doc/MT3项目完整技术体系总结.md](MT3项目完整技术体系总结.md) 搜索错误信息

3. **查看常见问题**:
   - [doc/MT3项目完整技术体系总结.md](MT3项目完整技术体系总结.md) 第七章

---

## 🎯 下一步行动

### 检查通过后

1. **开始编译**:
   ```batch
   build_mt3_v120_complete.bat
   ```

2. **监控进度**:
   - 预计28分钟
   - 观察输出无错误

3. **编译完成后**:
   ```batch
   # 复制DLL
   copy_runtime_dlls.bat

   # 运行游戏
   cd client\resource\bin\release
   MT3.exe
   ```

4. **验证功能**:
   - 游戏正常启动
   - FPS稳定在55-60
   - 无错误提示

---

## 📝 附录: 快速命令参考

### 检查命令

```batch
# 1. 检查编译器
cl

# 2. 检查MSBuild
msbuild /version

# 3. 检查v120工具集
dir "C:\Program Files (x86)\Microsoft Visual Studio 12.0"

# 4. 检查项目文件
dir *.vcxproj

# 5. 检查DLL
dir client\resource\bin\debug\*.dll

# 6. 测试运行
cd client\resource\bin\debug && MT3原始.exe

# 7. 测试编译
msbuild common\lua\lua.vcxproj /t:Build /p:Configuration=Release /p:Platform=Win32 /p:PlatformToolset=v120
```

---

**文档版本**: 1.0
**最后更新**: 2025-10-21
**适用项目版本**: MT3 v1.0+

**祝编译顺利!** 🚀
